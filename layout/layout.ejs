<!-- 通用模板 -->

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <!-- jquery -->
  <script src="https://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="https://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
  
  <!-- 搜索功能 -->
  <%- partial('partial/head.ejs') %>
  
  <%- css('css/style') %>

</head>

<body onload="my_load()" onresize="my_resize()">

  <!-- latex公式加载 -->
  <%
    var temp_latex = 0;
    if (page.latex == null) {
      temp_latex = 1;
    } else if (page.latex == 2) {
      temp_latex = 2;
    }
  %>

  <% if (temp_latex == 1) { %>
  <!-- mathjax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="<%- theme.latex.mathjax %>"></script>
  <% } else if (temp_latex == 2) { %>

  <!-- katex -->
    <link rel="stylesheet" href="<%- theme.latex.katex %>/dist/katex.min.css" integrity="sha384-dbVIfZGuN1Yq7/1Ocstc1lUEm+AT+/rCkibIcC/OmWo5f0EA48Vf8CytHzGrSwbQ" crossorigin="anonymous">
    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="<%- theme.latex.katex %>/dist/katex.min.js" integrity="sha384-2BKqo+exmr9su6dir+qCw08N2ZKRucY4PrGQPPWU1A7FtlCGjmEGFqXCv5nyM5Ij" crossorigin="anonymous"></script>
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="<%- theme.latex.katex %>/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    
    <script>
      $(document).ready(setTimeout(function()
      {
        renderMathInElement(document.body,
        {
          // ...options...
          delimiters: [
            { left: "$$", right: "$$", display: true },
            { left: "$", right: "$", display: false }
            // { left: "\\[", right: "\\]", display: true }
          ]
        });
      }, 1000));
    </script>
  <% } %>


  
  <% if (theme.debug.enable) { %>
    <p>is home: <%- is_home() %></p>
    <p>is tag: <%- is_tag() %></p>
    <p>is category: <%- is_category() %></p>
    <p>is archive: <%- is_archive() %></p>
    <p>is post: <%- is_post() %></p>
    <p>pagecur: <%- page.current %></p>
  <% } %>
  
  <!-- 链接 -->
  <%- partial('partial/header') %>
  
  <!-- 搜索功能 -->
  <%- js('js/load', 'js/search') %>

  <!-- 手写代码高亮 -->
  <%- js('js/highlight') %>

  <!-- 对应每个网页的layout -->
  <%- body -%>

  <%- js('js/change')%>
</body>

</html>